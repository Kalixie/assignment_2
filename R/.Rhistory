names(dfBINs.spread)
dfBINs.spread.by.country <- dfBINs.spread %>%
remove_rownames %>%
column_to_rownames(var = "bin_uri")
View(dfBINs.spread)
source("C:/Users/sabri/OneDrive/Desktop/Guelph/6210/TaxonProj/R/testscript.R", echo = TRUE)
source("C:/Users/sabri/OneDrive/Desktop/Guelph/6210/TaxonProj/R/testscript.R", echo = TRUE)
View(dfBINs.spread)
View(dfCount.by.BIN)
source("C:/Users/sabri/OneDrive/Desktop/Guelph/6210/TaxonProj/R/Drosophila_3.R", echo = TRUE)
source("C:/Users/sabri/OneDrive/Desktop/Guelph/6210/TaxonProj/R/Drosophila_3.R", echo = TRUE)
ggplot(hm_bin_diversity, aes(x = bin_region, y = bin_counts, fill = bin_region)) +
geom_col() +
geom_text(aes(label = bin_counts), vjust = -0.5, size = 3) +
labs(
title = "BIN Diversity: Hawaii vs Mainland USA",
x = "BIN Collection Region",
y = "Distinct BIN Count"
) +
ylim(0, 150) +
scale_fill_manual(
name = "Group",
values = c("Hawaii" = "blue", "Mainland USA" = "orange2", "Shared" = "gray")
) +
theme(
plot.background = element_rect(
fill = "white", colour = "snow2",
linewidth = 0.5, linetype = "solid"
)
)
ggplot(hm_bin_diversity, aes(x = bin_region, y = bin_counts, fill = bin_region)) +
geom_col() +
geom_text(aes(label = bin_counts), vjust = -0.5, size = 3) +
labs(
title = "BIN Diversity: Hawaii vs Mainland USA",
x = "BIN Collection Region",
y = "Distinct BIN Count"
) +
ylim(0, 150) +
scale_fill_manual(
name = "Group",
values = c("Hawaii" = "blue", "Mainland USA" = "orange2", "Shared" = "gray")
) +
theme(
plot.background = element_rect(
fill = "snow2", colour = "white",
linewidth = 0.5, linetype = "solid"
)
ggplot(hm_bin_diversity, aes(x = bin_region, y = bin_counts, fill = bin_region)) +
ggplot(hm_bin_diversity, aes(x = bin_region, y = bin_counts, fill = bin_region)) +
geom_col() +
geom_text(aes(label = bin_counts), vjust = -0.5, size = 3) +
labs(
title = "BIN Diversity: Hawaii vs Mainland USA",
x = "BIN Collection Region",
y = "Distinct BIN Count"
) +
ylim(0, 150) +
scale_fill_manual(
name = "Group",
values = c("Hawaii" = "blue", "Mainland USA" = "orange2", "Shared" = "gray")
) +
theme(
plot.background = element_rect(
fill = "snow2", colour = "white",
linewidth = 0.5, linetype = "solid"
)
)
ggplot(hm_bin_diversity, aes(x = bin_region, y = bin_counts, fill = bin_region)) +
geom_col() +
geom_text(aes(label = bin_counts), vjust = -0.5, size = 3) +
labs(
title = "BIN Diversity: Hawaii vs Mainland USA",
x = "BIN Collection Region",
y = "Distinct BIN Count"
) +
ylim(0, 150) +
scale_fill_manual(
name = "Group",
values = c("Hawaii" = "blue", "Mainland USA" = "orange2", "Shared" = "gray")
) +
theme(
plot.background = element_rect(
fill = "white", colour = "white",
linewidth = 0.5, linetype = "solid"
)
)
source("C:/Users/sabri/OneDrive/Desktop/Guelph/6210/TaxonProj/R/Drosophila_3.R", echo = TRUE)
source("C:/Users/sabri/OneDrive/Desktop/Guelph/6210/TaxonProj/R/Drosophila_3.R", echo = TRUE)
source("C:/Users/sabri/OneDrive/Desktop/Guelph/6210/TaxonProj/R/Drosophila_3.R", echo = TRUE)
source("C:/Users/sabri/OneDrive/Desktop/Guelph/6210/TaxonProj/R/Drosophila_3.R", echo = TRUE)
mean_bins
var_bins
View(df_H)
source("C:/Users/sabri/OneDrive/Desktop/Guelph/6210/TaxonProj/R/Drosophila_3.R", echo = TRUE)
View(dfh_bin_regions)
ggplot(dfh_bin_regions, aes(x = island_age, y = bins, fill = island)) +
geom_col(show.legend = FALSE) +
geom_text(aes(label = distinct_bins), vjust = -0.5, size = 4) +
theme_minimal() +
labs(
title = "Distinct BINs by Hawaiian Island",
x = "Island (Ordered by Age)",
y = "Number of Distinct BINs"
)
ggplot(dfh_bin_regions, aes(x = island_age, y = bins, fill = bins)) +
geom_col(show.legend = FALSE) +
geom_text(aes(label = distinct_bins), vjust = -0.5, size = 4) +
theme_minimal() +
labs(
title = "Distinct BINs by Hawaiian Island",
x = "Island (Ordered by Age)",
y = "Number of Distinct BINs"
)
ggplot(dfh_bin_regions, aes(x = island_age, y = bins, fill = bins)) +
geom_col(show.legend = FALSE) +
geom_text(aes(label = bins), vjust = -0.5, size = 4) +
theme_minimal() +
labs(
title = "Distinct BINs by Hawaiian Island",
x = "Island (Ordered by Age)",
y = "Number of Distinct BINs"
)
ggplot(dfh_bin_regions, aes(x = bins, y = island_age, fill = bins)) +
geom_col() +
geom_text(aes(label = bins), vjust = -0.5, size = 3) +
labs(
title = "BIN Diversity: Hawaii vs Mainland USA",
x = "BIN Collection Region",
y = "Distinct BIN Count"
) +
ylim(0, 60) +
theme(
plot.background = element_rect(
fill = "snow2", colour = "snow2",
linewidth = 0.5, linetype = "solid"
)
)
ggplot(dfh_bin_regions, aes(x = factor(island_age), y = bins, fill = island_age)) +
geom_col() +
geom_text(aes(label = bins), vjust = -0.5, size = 4) +
scale_fill_gradient(low = "steelblue", high = "orange") +
theme_minimal() +
labs(
title = "Distinct BINs by Island Age",
x = "Island Age (millions of years)",
y = "Number of Distinct BINs"
)
ggplot(dfh_bin_regions, aes(x = factor(island_age), y = bins, fill = island_age)) +
geom_col() +
geom_text(aes(label = bins), vjust = -0.5, size = 4) +
scale_fill_gradient(low = "blue", high = "orange") +
theme_minimal() +
labs(
title = "Distinct BINs by Island Age",
x = "Island Age (millions of years)",
y = "Number of Distinct BINs"
)
ggplot(dfh_bin_regions, aes(x = factor(island_age), y = bins, fill = island_age)) +
geom_col() +
geom_text(aes(label = bins), vjust = -0.5, size = 4) +
scale_fill_gradient(low = "blue", high = "red") +
theme_minimal() +
labs(
title = "Distinct BINs by Island Age",
x = "Island Age (millions of years)",
y = "Number of Distinct BINs"
)
ggplot(dfh_bin_regions, aes(x = factor(island_age), y = bins, fill = island_age)) +
geom_col() +
geom_text(aes(label = bins), vjust = -0.5, size = 4) +
scale_fill_gradient(low = "blue", high = "orange2") +
theme_minimal() +
labs(
title = "Distinct BINs by Island Age",
x = "Island Age (millions of years)",
y = "Number of Distinct BINs"
)
ggplot(dfh_bin_regions, aes(x = factor(island_age), y = bins, fill = island_age)) +
geom_col() +
geom_text(aes(label = bins), vjust = -0.5, size = 4) +
scale_fill_gradient(low = "blue", high = "orange2") +
theme_minimal() + ylim(0, 70) '+'
ggplot(dfh_bin_regions, aes(x = factor(island_age), y = bins, fill = island_age)) +
geom_col() +
geom_text(aes(label = bins), vjust = -0.5, size = 4) +
scale_fill_gradient(low = "blue", high = "orange2") +
theme_minimal() + ylim(0, 70) +
labs(
title = "Distinct BINs by Island Age",
x = "Island Age (millions of years)",
y = "Number of Distinct BINs"
)
ggplot(dfh_bin_regions, aes(x = factor(island_age), y = bins, fill = island_age)) +
geom_col() +
geom_text(aes(label = bins), vjust = -0.5, size = 4) +
scale_fill_gradient(low = "blue", high = "orange2") +
theme_minimal() + ylim(0, 60) +
labs(
title = "Distinct BINs by Island Age",
x = "Island Age (millions of years)",
y = "Number of Distinct BINs"
)
ggplot(dfh_bin_regions, aes(x = factor(island_age), y = bins, fill = island_age)) +
geom_col() +
geom_text(aes(label = bins), vjust = -0.5, size = 4) +
theme_minimal() + ylim(0, 60) +
labs(
title = "Distinct BINs by Island Age",
x = "Island Age (millions of years)",
y = "Number of Distinct BINs"
)
ggplot(dfh_bin_regions, aes(x = factor(island_age), y = bins, fill = island_age)) +
geom_col() +
geom_text(aes(label = bins), vjust = -0.5, size = 4) +
theme_minimal() + ylim(0, 60) +
scale_fill_manual(
name = "Group")
ggplot(dfh_bin_regions, aes(x = factor(island_age), y = bins, fill = island_age)) +
geom_col() +
geom_text(aes(label = bins), vjust = -0.5, size = 4) +
theme_minimal() + ylim(0, 60) +
scale_fill_manual(
name = "Group") +
labs(
title = "Distinct BINs by Island Age",
x = "Island Age (millions of years)",
y = "Number of Distinct BINs"
)
ggplot(dfh_bin_regions, aes(x = factor(island_age), y = bins, fill = island_age)) +
geom_col() +
geom_text(aes(label = bins), vjust = -0.5, size = 4) +
theme_minimal() + ylim(0, 60) +
labs(
title = "Distinct BINs by Island Age",
x = "Island Age (millions of years)",
y = "Number of Distinct BINs"
)
ggplot(dfh_bin_regions, aes(x = factor(island_age), y = bins, fill = island_age)) +
geom_col() +
geom_text(aes(label = bins), vjust = -0.5, size = 4) +
theme_minimal() + ylim(0, 60) +
labs(
title = "Distinct BINs by Island Age",
x = "Island Age (millions of years)",
y = "Number of Distinct BINs",
fill = "Island Age"
)
source("C:/Users/sabri/OneDrive/Desktop/Guelph/6210/TaxonProj/R/Drosophila_3.R", echo = TRUE)
source("C:/Users/sabri/OneDrive/Desktop/Guelph/6210/TaxonProj/R/Drosophila_3.R", echo = TRUE)
ggplot(dfh_bin_regions, aes(x = factor(island_age), y = bins, fill = island_age)) +
geom_col() +
geom_text(aes(label = bins), vjust = -0.5, size = 4) +
scale_fill_gradient(low = "blue", high = "orange2")+
theme_minimal() + ylim(0, 60) +
labs(
title = "Distinct BINs by Island Age",
x = "Island Age (millions of years)",
y = "Number of Distinct BINs",
fill = "Island Age"
) + theme(
plot.background = element_rect(
fill = "snow2", colour = "snow2",
linewidth = 0.5, linetype = "solid"
)
)
ggplot(dfh_bin_regions, aes(x = island_age, y = bins)) +
geom_point(size = 3, color = "orange3") +
stat_smooth(
method = MASS::glm.nb,
formula = y ~ x,
color = "darkblue",
se = TRUE
) +
labs(
title = "Negative Binomial Regression: Island Age vs BIN Diversity",
x = "Island Age (million years)",
y = "Distinct BIN Count"
) +
theme_minimal() +
theme(
plot.background = element_rect(
fill = "snow2", colour = "snow2",
linewidth = 0.5, linetype = "solid"
)
)
ggplot(dfh_bin_regions, aes(x = island_age, y = bins)) +
geom_point(size = 3, color = "orange3") +
stat_smooth(
method = MASS::glm.nb,
formula = y ~ x,
color = "darkblue",
se = TRUE
) +
labs(
title = "Negative Binomial Regression: Island Age vs BIN Diversity",
x = "Island Age (million years)",
y = "Distinct BIN Count"
) +
theme_minimal()
ggplot(dfh_bin_regions, aes(x = island_age, y = bins)) +
geom_point(size = 3, color = "orange3") +
stat_smooth(
method = MASS::glm.nb,
formula = y ~ x,
color = "darkblue",
se = TRUE
) +
labs(
title = "Negative Binomial Regression: Island Age vs BIN Diversity",
x = "Island Age (million years)",
y = "Distinct BIN Count"
) +
theme_minimal() +   +
theme(plot.background = element_rect(
fill = "snow2", colour = "snow2",
linewidth = 0.5, linetype = "solid"
))
ggplot(dfh_bin_regions, aes(x = island_age, y = bins)) +
geom_point(size = 3, color = "orange3") +
stat_smooth(
method = MASS::glm.nb,
formula = y ~ x,
color = "darkblue",
se = TRUE
) +
labs(
title = "Negative Binomial Regression: Island Age vs BIN Diversity",
x = "Island Age (million years)",
y = "Distinct BIN Count"
) +
theme_minimal() +
theme(plot.background = element_rect(
fill = "snow2", colour = "snow2",
linewidth = 0.5, linetype = "solid"
))
ggplot(dfh_bin_regions, aes(x = island_age, y = bins)) +
geom_point(size = 3, color = "orange3") +
stat_smooth(
method = MASS::glm.nb,
formula = y ~ x,
color = "darkblue",
se = TRUE
) +
labs(
title = "Negative Binomial Regression: Island Age vs BIN Diversity",
x = "Island Age (millions of years)",
y = "Distinct BIN Count"
) +
theme_minimal() +
theme(
plot.background = element_rect(   # outer area around plot
fill = "snow2", colour = "snow2"
),
panel.background = element_rect(  # main plotting area
fill = "white", colour = "white"
),
panel.grid.major = element_line(color = "gray90"), # optional: softer grid
panel.grid.minor = element_blank()                 # optional: remove minor gridlines
)
source("C:/Users/sabri/OneDrive/Desktop/Guelph/6210/TaxonProj/R/Drosophila_3.R", echo = TRUE)
ggplot(dfh_bin_regions, aes(x = factor(island_age), y = bins, fill = island_age)) +
geom_col() +
geom_text(aes(label = bins), vjust = -0.5, size = 4) +
scale_fill_gradient(low = "blue", high = "orange2")+
theme_minimal() + ylim(0, 60) +
labs(
title = "Distinct BINs by Island Age",
x = "Island Age (millions of years)",
y = "Number of Distinct BINs",
fill = "Island Age"
) +
theme(
plot.background = element_rect(   # outer area around plot
fill = "snow2", colour = "snow2"
),
panel.background = element_rect(  # main plotting area
fill = "white", colour = "white"
),
panel.grid.major = element_line(color = "gray90"), # optional: softer grid
panel.grid.minor = element_blank()                 # optional: remove minor gridlines
)
ggplot(dfh_bin_regions, aes(x = island_age, y = bins)) +
geom_point(size = 3, color = "orange3") +
stat_smooth(
method = MASS::glm.nb,
formula = y ~ x,
color = "darkblue",
se = TRUE
) +
labs(
title = "Negative Binomial Regression: Island Age vs BIN Diversity",
x = "Island Age (millions of years)",
y = "Distinct BIN Count"
) +
theme(
plot.background = element_rect(fill = "snow2", colour = "snow2"),
panel.background = element_rect(fill = "white", colour = "white"),
panel.grid.major = element_line(color = "gray90"),
)
ggplot(dfh_bin_regions, aes(x = factor(island_age), y = bins, fill = island_age)) +
geom_col() +
geom_text(aes(label = bins), vjust = -0.5, size = 4) +
scale_fill_gradient(low = "blue", high = "orange2") + ylim(0, 60) +
labs(
title = "Distinct BINs by Island Age",
x = "Island Age (millions of years)",
y = "Number of Distinct BINs",
fill = "Island Age"
) +
theme(
plot.background = element_rect(fill = "snow2", colour = "snow2"),
panel.background = element_rect(fill = "white", colour = "white"),
panel.grid.major = element_line(color = "gray90")
)
source("C:/Users/sabri/OneDrive/Desktop/Guelph/6210/TaxonProj/R/Drosophila_3.R", echo = TRUE)
styler:::style_active_file()
source("C:/Users/sabri/OneDrive/Desktop/Guelph/6210/TaxonProj/R/Drosophila_3.R", echo = TRUE)
View(dfh_bin_regions)
View(dfh_island)
test1 <- dfh_island %>%
group_by(island_age == 0.5)
View(test1)
test1 <- dfh_island %>%
filter(island_age == 0.5)
View(test1)
View(dfh_bin_regions)
test1 <- dfh_island %>%
filter(island_age == 0.5)
test2 <- dfh_island %>%
filter(island_age == 1.3)
test3 <- dfh_island %>%
filter(island_age == 1.9)
test4 <- dfh_island %>%
filter(island_age == 3.0)
test5 <- dfh_island %>%
filter(island_age == 5.1)
test1 <- dfh_island %>%
filter(island_age == 0.5) %>%
select(bin_uri, island_age)
test2 <- dfh_island %>%
filter(island_age == 1.3) %>%
select(bin_uri, island_age)
test3 <- dfh_island %>%
filter(island_age == 1.9)%>%
select(bin_uri, island_age)
test4 <- dfh_island %>%
filter(island_age == 3.0)%>%
select(bin_uri, island_age)
test5 <- dfh_island %>%
filter(island_age == 5.1)%>%
select(bin_uri, island_age)
View(test1)
View(test2)
View(test3)
View(test4)
View(test5)
library(ggvenn)
install.packages(ggven)
install.packages("ggven")
islands <- list(
"0.5" = test1$bin_uri,
"1.3" = test2$bin_uri,
"1.9" = test3$bin_uri,
"3.0" = test4$bin_uri,
"5.1" = test5$bin_uri
)
# Create a matrix showing how many BINs overlap between islands
overlap_matrix <- sapply(islands, function(x) sapply(islands, function(y) length(intersect(x, y))))
overlap_matrix
# Combine all BINs into one vector
all_bins <- c(test1$bin_uri, test2$bin_uri, test3$bin_uri, test4$bin_uri, test5$bin_uri)
# Find BINs that appear in more than one island
shared_bins <- all_bins[duplicated(all_bins)]
unique_shared_bins <- unique(shared_bins)
# View them
unique_shared_bins
# Put data in a named list
islands <- list(
"0.5" = test1$bin_uri,
"1.3" = test2$bin_uri,
"1.9" = test3$bin_uri,
"3.0" = test4$bin_uri,
"5.1" = test5$bin_uri
)
View(islands)
# Put data in a named list
islands <- list(
"0.5" = test1$bin_uri,
"1.3" = test2$bin_uri,
"1.9" = test3$bin_uri,
"3.0" = test4$bin_uri,
"5.1" = test5$bin_uri
)
# Create a matrix showing how many BINs overlap between islands
overlap_matrix <- sapply(islands, function(x) sapply(islands, function(y) length(intersect(x, y))))
overlap_matrix
# Combine all BINs into one vector
all_bins <- c(test1$bin_uri, test2$bin_uri, test3$bin_uri, test4$bin_uri, test5$bin_uri)
# Find BINs that appear in more than one island
shared_bins <- all_bins[duplicated(all_bins)]
unique_shared_bins <- unique(shared_bins)
# View them
unique_shared_bins
test6 <- length(intersect(test1$bin_uri, test2$bin_uri))
test6 <- length(intersect(test1$bin_uri, test4$bin_uri))
source("C:/Users/sabri/OneDrive/Desktop/Guelph/6210/TaxonProj/R/Drosophila_3.R", echo = TRUE)
source("C:/Users/sabri/OneDrive/Desktop/Guelph/6210/TaxonProj/R/Drosophila_3.R", echo = TRUE)
source("C:/Users/sabri/OneDrive/Desktop/Guelph/6210/TaxonProj/R/Drosophila_3.R", echo = TRUE)
styler:::style_active_file()
source("C:/Users/sabri/OneDrive/Desktop/Guelph/6210/Assignment_1_Sabrina/R/Drosophila_3.R", echo = TRUE)
source("C:/Users/sabri/OneDrive/Desktop/Guelph/6210/Assignment_1_Sabrina/R/Drosophila_3.R", echo = TRUE)
